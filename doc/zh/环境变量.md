环境变量是在特定的开发环境（开发、测试、uat等）下，保存的一份数据集，环境变量是发送网络请求或者执行单测的一个重要数据源。环境变量根据作用范围可以分为全局环境变量、项目环境变量、迭代环境变量和单测环境变量。

## 环境变量创建

### 全局环境变量

![image-20250201111914233](https://gitee.com/onlinetool/mypostman/raw/master/doc/images/image-20250201111914233.png)

全局环境变量入口在设置->全局环境变量->选择环境->添加。全局环境变量在所有的网络请求和单测中都可以作为参数使用，比如测试使用的账户uid，登录的appSessionId等；

### 项目环境变量

![image-20250201112116117](https://gitee.com/onlinetool/mypostman/raw/master/doc/images/image-20250201112116117.png)

项目环境变量入口在项目->选择项目->项目环境变量->选择环境->添加。项目环境变量仅在与该项目有关的接口参与发送网络请求或者单测时有效，比如当前项目接口访问的域名前缀 api_host；

### 迭代环境变量

![image-20250201112349424](https://gitee.com/onlinetool/mypostman/raw/master/doc/images/image-20250201112349424.png)

迭代环境变量入口在迭代->选择迭代->迭代环境变量->选择环境->添加。迭代环境变量是为了开发当前迭代涉及的功能的过程中，进行发送网络请求和单元测试，同时不想污染全局数据源的一个变量容器，是日常开发中最常使用的数据源。在迭代环境变量中还可以通过选择项目，为迭代中的某个项目特殊指定一些环境变量的值，优先级为 迭代+项目 > 迭代 > 项目 > 全局。

### 单测环境变量

![image-20250201112613473](https://gitee.com/onlinetool/mypostman/raw/master/doc/images/image-20250201112613473.png)

![image-20250201112730694](https://gitee.com/onlinetool/mypostman/raw/master/doc/images/image-20250201112730694.png)

单测环境变量入口在项目->选择项目->单测->选择单测->环境变量->添加。当单测从迭代拷贝到项目时，会将该单测涉及的所有环境变量转化为单测环境变量，用于对项目进行回归测试时使用的特定单测用例中。单测环境变量对该单测中涉及的所有步骤流程有效，初始值从迭代环境变量中导出，因此优先级为 单测+项目 > 单测 > 项目 > 全局。

## 环境变量使用

### 发送普通网络请求

![image-20250201113237028](https://gitee.com/onlinetool/mypostman/raw/master/doc/images/image-20250201113237028.png)

当你通过 请求->发送请求->选择项目->选择环境 的流程对特定项目进行接口的网络请求时，输入类似 **{{api_host}}** 的内容时，实际上在引用 key 为 api_host 的环境变量，在这种情况下，能够使用的环境变量为项目环境变量和全局环境变量，优先级为 项目环境变量 > 迭代环境变量。

### 从迭代入口发送网络请求

![image-20250201114029879](https://gitee.com/onlinetool/mypostman/raw/master/doc/images/image-20250201114029879.png)

当你通过 迭代->选择迭代->文档->发送请求 的流程从迭代的入口进入到发送网络请求的页面时，在这种情况下，能够使用到迭代环境变量、项目环境变量和全局环境变量，优先级为 迭代+项目 > 迭代 > 项目 > 全局。

### 从历史记录搜索发送网络请求

![image-20250201113806420](https://gitee.com/onlinetool/mypostman/raw/master/doc/images/image-20250201113806420.png)

当你通过 请求->请求记录->选择项目->选择环境 的流程搜索到网络请求的发送记录，点击查看按钮发送网络请求时，此时会回放当初发送网络请求时的场景，如果当初只是发送普通网络请求，没有关联版本迭代，则无法使用迭代环境变量，于是只是将数据都填充好，由你点击发送按钮发送网络请求，能够使用的环境变量为项目环境变量和全局环境变量，优先级为 项目环境变量 > 全局环境变量。如果当初通过迭代入口发送网络请求，该网络请求已经关联了特定迭代，能够使用的环境变量为迭代环境变量、项目环境变量和全局环境变量，优先级为 迭代环境变量 > 项目环境变量 > 全局环境变量。

### 执行迭代单测

![image-20250201114824174](https://gitee.com/onlinetool/mypostman/raw/master/doc/images/image-20250201114824174.png)
![image-20250201114859768](https://gitee.com/onlinetool/mypostman/raw/master/doc/images/image-20250201114859768.png)
![image-20250201114926824](https://gitee.com/onlinetool/mypostman/raw/master/doc/images/image-20250201114926824.png)

当你通过 迭代->选择迭代->单测 入口添加或者修改单测，根据项目和URI选择单测的接口，填充单测数据时，可以选择的一个数据源是环境变量，此时的环境变量能够获取当前版本迭代的数据，因此优先级为 迭代+项目 > 迭代 > 项目 > 全局。

### 执行项目单测

![image-20250201115115257](https://gitee.com/onlinetool/mypostman/raw/master/doc/images/image-20250201115115257.png)

当你在项目中通过选择测试用例（可多选）-> 选择环境 -> 执行单测时，单测环境变量生效，初始值从迭代环境变量继承，优先级为 单测+项目 > 单测 > 项目 > 全局。可以点击图中入口进行修改，修改后只对当前单测有效。